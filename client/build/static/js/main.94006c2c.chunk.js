(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,s){"use strict";s.r(t);var c=s(2),a=s(29),n=s.n(a),r=s(104),i=s(17),o=s(57),j=s.n(o).a.create({baseURL:"https://post-app-task.herokuapp.com//api",responseType:"json"}),u=function(e){var t=e.queryKey;return j.get("/user/".concat(t[1],"/posts"))},l=function(e){return j.post("/post",e)},d=function(e){var t=e.id,s=e.data;return j.patch("/post/".concat(t),s)},m=s(20),b=s.n(m),O=s(13),h=s(10),p=s(31),f=s(11);var x=s(0);function v(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),s=t[0],a=t[1],n="61a2641458c1d4456e460861",r=function(e,t){var s=Object(f.useQueryClient)(),c=Object(f.useMutation)(t,{onMutate:function(){var t=Object(p.a)(b.a.mark((function t(c){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.cancelQueries(e);case 2:return a=s.getQueryData(e),s.setQueryData(e,(function(e){var t=Object(h.a)({},e);return t.data.data=[c].concat(Object(O.a)(t.data.data)),console.log("clone",t),t})),t.abrupt("return",{previousData:a});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onError:function(t,c,a){s.setQueryData(e,a.previousData)},onSuccess:function(){},onSettled:function(){s.invalidateQueries(e)}});return c}(["posts",n],l);return Object(x.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),s){var t={_id:Math.floor(100*Math.random()),title:s,user:n,content:"",createdAt:(new Date).toISOString(),like:[],comment:[]};r.mutate(t),a("")}},className:"addPost",children:[Object(x.jsxs)("div",{className:"head",children:[Object(x.jsx)("div",{className:"circle",children:Object(x.jsx)("img",{src:"/assets/images/profile.jpeg",alt:"profile"})}),Object(x.jsx)("h1",{children:"What is on your mind ?"})]}),Object(x.jsx)("input",{type:"text",className:"messageInput",value:s,placeholder:"Start writing from here ...",onChange:function(e){return a(e.target.value)},autoFocus:!0}),Object(x.jsxs)("div",{className:"footer",children:[Object(x.jsxs)("button",{type:"button",className:"photoBtn",children:[Object(x.jsx)("img",{src:"/assets/images/pictureIcon.png",alt:"icon"}),Object(x.jsx)("span",{children:"Photo/Video"})]}),Object(x.jsx)("button",{disabled:""===s,className:"postBtn",type:"submit",children:"Post it"})]})]})}var g=s(103),N=s(105);function k(e){var t=e._id,s=e.like,a=e.createdAt,n=e.message,r=e.updatePost,o=e.commentData,j=e.userId,u=e.postId,l=Object(c.useState)(!1),d=Object(i.a)(l,2),m=d[0],b=d[1],h=Object(c.useState)(n||""),p=Object(i.a)(h,2),f=p[0],v=p[1],k=s.includes(j);return Object(x.jsxs)("div",{className:"flexCenter commentSec",children:[Object(x.jsx)("img",{className:"profile",src:"/assets/images/profile.jpeg",alt:"profile"}),Object(x.jsxs)("div",{className:"message",children:[Object(x.jsxs)("div",{className:"flexBetweenCenter",children:[Object(x.jsx)("h3",{children:"Patrick Shuf"}),Object(x.jsxs)("p",{children:[Object(g.a)(new Date,Object(N.a)(a))," ago"]})]}),Object(x.jsx)("h5",{children:"Professional-Student"}),m?Object(x.jsx)("form",{onSubmit:function(){if(f){var e=o.filter((function(e){return e._id===t&&(e.message=f),e}));r.mutate({id:u,data:{comment:e}}),b(!1)}},children:Object(x.jsx)("input",{className:"editInput",type:"text",value:f,onChange:function(e){return v(e.target.value)},autoFocus:!0})}):Object(x.jsx)("h4",{children:n}),Object(x.jsxs)("div",{className:"flexCenter commentActions",children:[Object(x.jsxs)("div",{className:"item",children:[s.length," Likes"]}),Object(x.jsxs)("button",{onClick:function(){var e=o.filter((function(e){return e._id===t&&(e.like=k?e.like.filter((function(e){return e!=j})):[].concat(Object(O.a)(e.like),[j])),e}));r.mutate({id:u,data:{comment:e}})},children:[Object(x.jsx)("img",{src:k?"/assets/images/heart-like.svg":"/assets/images/heart.svg",alt:"heart"}),Object(x.jsx)("span",{children:"Like"})]}),Object(x.jsxs)("button",{onClick:function(){return b((function(e){return!e}))},children:[Object(x.jsx)("img",{src:"/assets/images/edit.svg",alt:"edit"}),Object(x.jsx)("span",{children:"Edit"})]}),Object(x.jsxs)("button",{onClick:function(){var e=o.filter((function(e){return e._id!==t}));r.mutate({id:u,data:{comment:e}})},children:[Object(x.jsx)("img",{src:"/assets/images/trash.svg",alt:"trash"}),Object(x.jsx)("span",{children:"Delete"})]})]})]})]})}function y(e){var t=e.view,s=e.commentData,a=e.userId,n=e.updatePost,r=e.postId,o=Object(c.useState)(""),j=Object(i.a)(o,2),u=j[0],l=j[1];return Object(x.jsxs)("div",{className:t?"comment show":"comment",children:[Object(x.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),u){var t={message:u,_id:Math.floor(100*Math.random()),createdAt:(new Date).toISOString(),like:[]};n.mutate({id:r,data:{comment:[].concat(Object(O.a)(s),[t])}}),l("")}},className:"addComment",children:[Object(x.jsx)("img",{className:"profile",src:"/assets/images/profile.jpeg",alt:"profile"}),Object(x.jsx)("input",{type:"text",placeholder:"Add a comment",value:u,onChange:function(e){return l(e.target.value)},autoFocus:!0})]}),s.length>0&&s.map((function(e){return Object(x.jsx)(k,Object(h.a)(Object(h.a)({},e),{},{updatePost:n,userId:a,postId:r,commentData:s}))}))]})}function D(e){var t=e.title,s=e.like,a=e.comment,n=e.createdAt,r=e.userId,o=e._id,j=Object(c.useState)(!1),u=Object(i.a)(j,2),l=u[0],m=u[1],v=s.includes(r),k=function(e,t){var s=Object(f.useQueryClient)(),c=Object(f.useMutation)(t,{onMutate:function(){var t=Object(p.a)(b.a.mark((function t(c){var a,n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.id,n=c.data,t.next=3,s.cancelQueries(e);case 3:return r=s.getQueryData(e),s.setQueryData(e,(function(e){var t=Object(h.a)({},e),s=t.data.data.reduce((function(e,t){return t._id===a&&(t=Object(h.a)(Object(h.a)({},t),n)),[].concat(Object(O.a)(e),[t])}),[]);return console.log(s,"updated"),t.data.data=s,t})),t.abrupt("return",{previousData:r});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onError:function(t,c,a){s.setQueryData(e,a.previousData)},onSuccess:function(){},onSettled:function(){s.invalidateQueries(e)}});return c}(["posts",r],d);return Object(x.jsxs)("div",{className:"post",children:[Object(x.jsxs)("div",{className:"content",children:[Object(x.jsxs)("div",{className:"head",children:[Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)("img",{src:"/assets/images/profile.jpeg",alt:"profile",className:"cover"}),Object(x.jsxs)("div",{className:"right",children:[Object(x.jsx)("h3",{children:"Patrick Shuff"}),Object(x.jsxs)("div",{className:"flexCenter",children:[Object(x.jsx)("img",{src:"/assets/images/marker.svg"}),Object(x.jsx)("span",{children:"OH , USA"})]}),Object(x.jsxs)("p",{children:[Object(g.a)(new Date,Object(N.a)(n))," ago"]})]})]}),Object(x.jsx)("img",{src:"/assets/images/moreIcon.svg",alt:"moreIcon",className:"pointer"})]}),Object(x.jsx)("h1",{children:t}),Object(x.jsxs)("div",{className:"counter",children:[Object(x.jsxs)("h5",{children:[s.length," Likes"]}),Object(x.jsx)("span",{children:"."}),Object(x.jsxs)("h5",{children:[a.length," comments"]})]})]}),Object(x.jsxs)("div",{className:"footer",children:[Object(x.jsxs)("div",{className:"action",children:[Object(x.jsxs)("div",{onClick:function(){var e={id:o,data:{like:v?s.filter((function(e){return e!=r})):[].concat(Object(O.a)(s),[r])}};k.mutate(e)},className:"flexCenter",children:[Object(x.jsx)("img",{src:v?"/assets/images/heart-like.svg":"/assets/images/heart.svg",alt:"heart"}),Object(x.jsx)("span",{children:"Like"})]}),Object(x.jsxs)("div",{onClick:function(){return m((function(e){return!e}))},className:"flexCenter",children:[Object(x.jsx)("img",{src:"/assets/images/comment.svg",alt:"heart"}),Object(x.jsx)("span",{children:"Comment"})]})]}),Object(x.jsx)(y,{view:l,commentData:a,userId:r,updatePost:k,postId:o})]})]})}function S(e){var t=e.height,s=void 0===t?"70vh":t;return Object(x.jsx)("div",{className:"loader",style:{height:s},children:Object(x.jsxs)("div",{className:"sk-chase",children:[Object(x.jsx)("div",{className:"sk-chase-dot"}),Object(x.jsx)("div",{className:"sk-chase-dot"}),Object(x.jsx)("div",{className:"sk-chase-dot"}),Object(x.jsx)("div",{className:"sk-chase-dot"}),Object(x.jsx)("div",{className:"sk-chase-dot"}),Object(x.jsx)("div",{className:"sk-chase-dot"})]})})}function C(){var e,t="61a2641458c1d4456e460861",s=Object(f.useQuery)(["posts",t],u),c=s.data,a=s.isLoading,n=null===c||void 0===c||null===(e=c.data)||void 0===e?void 0:e.data;return Object(x.jsxs)("section",{className:"postWrapper",children:[a&&Object(x.jsx)(S,{}),a||n.map((function(e){return Object(x.jsx)(D,Object(h.a)(Object(h.a)({},e),{},{userId:t}),null===e||void 0===e?void 0:e._id)}))]})}s(90);function w(){return Object(x.jsxs)("div",{className:"landingPageWrapper",children:[Object(x.jsx)(v,{}),Object(x.jsx)(C,{})]})}function I(){return Object(x.jsx)(r.c,{children:Object(x.jsx)(r.a,{path:"/",component:w})})}function Q(){var e=Object(r.d)().pathname;return Object(c.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var P=function(){return Object(x.jsxs)("div",{className:"app",children:[Object(x.jsx)(Q,{}),Object(x.jsx)(I,{})]})},_=s(15),M=Object(_.a)(),A=(s(99),new f.QueryClient);A.setDefaultOptions({refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:6e3}),n.a.render(Object(x.jsx)(r.b,{forceRefresh:!0,history:M,children:Object(x.jsx)(f.QueryClientProvider,{client:A,children:Object(x.jsx)(P,{})})}),document.getElementById("root"))},90:function(e,t,s){},99:function(e,t,s){}},[[100,1,2]]]);
//# sourceMappingURL=main.94006c2c.chunk.js.map